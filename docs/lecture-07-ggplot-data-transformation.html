<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>8 Lecture 07 - ggplot / data transformation | [2019 UST 일반강의] R 프로그래밍과 데이터 분석</title>
  <meta name="description" content="2019년 UST 강의 R 프로그래밍 웹사이트">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="8 Lecture 07 - ggplot / data transformation | [2019 UST 일반강의] R 프로그래밍과 데이터 분석" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="2019년 UST 강의 R 프로그래밍 웹사이트" />
  <meta name="github-repo" content="https://greendaygh.github.io/Rprog2019/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Lecture 07 - ggplot / data transformation | [2019 UST 일반강의] R 프로그래밍과 데이터 분석" />
  
  <meta name="twitter:description" content="2019년 UST 강의 R 프로그래밍 웹사이트" />
  

<meta name="author" content="Haseong Kim">


<meta name="date" content="2019-05-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="lecture-06-multiple-plate-reader-ggplot.html">
<link rel="next" href="lecture-08-ggplot-data-transformation-using-dplyr.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Lecture 개요</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#goal--"><i class="fa fa-check"></i><b>1.1</b> Goal 강의 목표</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#references--"><i class="fa fa-check"></i><b>1.2</b> References 참고 자료</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#evaluation---"><i class="fa fa-check"></i><b>1.3</b> Evaluation 평가 세부 항목</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#schedule--"><i class="fa fa-check"></i><b>1.4</b> Schedule 강의 계획</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#lecture-note--"><i class="fa fa-check"></i><b>1.5</b> Lecture note 강의 자료</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lecture-01-r-introduction.html"><a href="lecture-01-r-introduction.html"><i class="fa fa-check"></i><b>2</b> Lecture 01 - R Introduction</a></li>
<li class="chapter" data-level="3" data-path="lecture-02-r-basics-i.html"><a href="lecture-02-r-basics-i.html"><i class="fa fa-check"></i><b>3</b> Lecture 02 - R basics I</a><ul>
<li class="chapter" data-level="3.1" data-path="lecture-02-r-basics-i.html"><a href="lecture-02-r-basics-i.html#exercise-2-1-who-function"><i class="fa fa-check"></i><b>3.1</b> exercise 2-1: who function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html"><i class="fa fa-check"></i><b>4</b> Lecture 03 - R Basics II</a><ul>
<li class="chapter" data-level="4.1" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#matrix-"><i class="fa fa-check"></i><b>4.1</b> matrix (행렬)</a></li>
<li class="chapter" data-level="4.2" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#data.frame"><i class="fa fa-check"></i><b>4.2</b> data.frame</a></li>
<li class="chapter" data-level="4.3" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#list"><i class="fa fa-check"></i><b>4.3</b> list</a></li>
<li class="chapter" data-level="4.4" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#file-"><i class="fa fa-check"></i><b>4.4</b> File 읽기/쓰기</a></li>
<li class="chapter" data-level="4.5" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#excel-file-"><i class="fa fa-check"></i><b>4.5</b> Excel file 읽기/쓰기</a></li>
<li class="chapter" data-level="4.6" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#exercise-3-2-standard-deviation"><i class="fa fa-check"></i><b>4.6</b> Exercise 3-2 standard deviation</a></li>
<li class="chapter" data-level="4.7" data-path="lecture-03-r-basics-ii.html"><a href="lecture-03-r-basics-ii.html#exercise-3-3-barplot-with-error-bars"><i class="fa fa-check"></i><b>4.7</b> Exercise 3-3 barplot with error bars</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html"><i class="fa fa-check"></i><b>5</b> Lecture 04 - Maze Robot</a><ul>
<li class="chapter" data-level="5.1" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#parameterargument-globallocal"><i class="fa fa-check"></i><b>5.1</b> Parameter/Argument, Global/Local</a></li>
<li class="chapter" data-level="5.2" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#exercise-4-1-matrix-indexing"><i class="fa fa-check"></i><b>5.2</b> Exercise 4-1: Matrix indexing</a></li>
<li class="chapter" data-level="5.3" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#top-down-design"><i class="fa fa-check"></i><b>5.3</b> Top-down design</a></li>
<li class="chapter" data-level="5.4" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#exercise-4-2-draw-world"><i class="fa fa-check"></i><b>5.4</b> Exercise 4-2: Draw world</a></li>
<li class="chapter" data-level="5.5" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#exercise-4-4-generate-map"><i class="fa fa-check"></i><b>5.5</b> Exercise 4-4: Generate map</a></li>
<li class="chapter" data-level="5.6" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#draw-blocks-and-walls"><i class="fa fa-check"></i><b>5.6</b> Draw blocks and walls</a></li>
<li class="chapter" data-level="5.7" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#move-one-step"><i class="fa fa-check"></i><b>5.7</b> Move one step</a></li>
<li class="chapter" data-level="5.8" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#sleep-for-delay"><i class="fa fa-check"></i><b>5.8</b> Sleep for delay</a></li>
<li class="chapter" data-level="5.9" data-path="lecture-04-maze-robot.html"><a href="lecture-04-maze-robot.html#move-50-steps"><i class="fa fa-check"></i><b>5.9</b> Move 50 steps</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html"><i class="fa fa-check"></i><b>6</b> Lecture 05 - Multiple plate reader file</a><ul>
<li class="chapter" data-level="6.1" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#file-io--"><i class="fa fa-check"></i><b>6.1</b> File I/O 파일 입출력</a></li>
<li class="chapter" data-level="6.2" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#plot-"><i class="fa fa-check"></i><b>6.2</b> plot 산포도</a></li>
<li class="chapter" data-level="6.3" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#hist-"><i class="fa fa-check"></i><b>6.3</b> hist 히스토그램</a></li>
<li class="chapter" data-level="6.4" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#boxplot-"><i class="fa fa-check"></i><b>6.4</b> boxplot 상자그래프</a></li>
<li class="chapter" data-level="6.5" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#barplot-"><i class="fa fa-check"></i><b>6.5</b> barplot 막대그래프</a></li>
<li class="chapter" data-level="6.6" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#other-examples--"><i class="fa fa-check"></i><b>6.6</b> other examples 그래프 예시</a></li>
<li class="chapter" data-level="6.7" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#multiplate-reader--"><i class="fa fa-check"></i><b>6.7</b> Multiplate reader 기능 구현</a></li>
<li class="chapter" data-level="6.8" data-path="lecture-05-multiple-plate-reader-file.html"><a href="lecture-05-multiple-plate-reader-file.html#multiplate-reader-function-"><i class="fa fa-check"></i><b>6.8</b> Multiplate reader function 만들기</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lecture-06-multiple-plate-reader-ggplot.html"><a href="lecture-06-multiple-plate-reader-ggplot.html"><i class="fa fa-check"></i><b>7</b> Lecture 06 - Multiple plate reader / ggplot</a><ul>
<li class="chapter" data-level="7.1" data-path="lecture-06-multiple-plate-reader-ggplot.html"><a href="lecture-06-multiple-plate-reader-ggplot.html#multiple_plate_excel_reader--"><i class="fa fa-check"></i><b>7.1</b> multiple_plate_excel_reader 함수 만들기</a></li>
<li class="chapter" data-level="7.2" data-path="lecture-06-multiple-plate-reader-ggplot.html"><a href="lecture-06-multiple-plate-reader-ggplot.html#multiple_plate_excel_reader2--"><i class="fa fa-check"></i><b>7.2</b> multiple_plate_excel_reader2 함수 업데이트</a></li>
<li class="chapter" data-level="7.3" data-path="lecture-06-multiple-plate-reader-ggplot.html"><a href="lecture-06-multiple-plate-reader-ggplot.html#read-data"><i class="fa fa-check"></i><b>7.3</b> Read data</a></li>
<li class="chapter" data-level="7.4" data-path="lecture-06-multiple-plate-reader-ggplot.html"><a href="lecture-06-multiple-plate-reader-ggplot.html#ggplot--barplot-"><i class="fa fa-check"></i><b>7.4</b> ggplot 이용 barplot 그리기</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html"><i class="fa fa-check"></i><b>8</b> Lecture 07 - ggplot / data transformation</a><ul>
<li class="chapter" data-level="8.1" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html#bar-graph-with-basic-graph-functions"><i class="fa fa-check"></i><b>8.1</b> Bar graph with basic graph functions</a></li>
<li class="chapter" data-level="8.2" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html#bar-graph-with-ggplot"><i class="fa fa-check"></i><b>8.2</b> Bar graph with ggplot</a></li>
<li class="chapter" data-level="8.3" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html#line-graph-with-ggplot"><i class="fa fa-check"></i><b>8.3</b> Line graph with ggplot</a></li>
<li class="chapter" data-level="8.4" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html#bar-graph-of-the-example-dataset"><i class="fa fa-check"></i><b>8.4</b> Bar graph of the example dataset</a></li>
<li class="chapter" data-level="8.5" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html#ddplyr---pipe-operator"><i class="fa fa-check"></i><b>8.5</b> ddplyr - pipe operator</a></li>
<li class="chapter" data-level="8.6" data-path="lecture-07-ggplot-data-transformation.html"><a href="lecture-07-ggplot-data-transformation.html#dplyr---important-functions"><i class="fa fa-check"></i><b>8.6</b> dplyr - Important functions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lecture-08-ggplot-data-transformation-using-dplyr.html"><a href="lecture-08-ggplot-data-transformation-using-dplyr.html"><i class="fa fa-check"></i><b>9</b> Lecture 08 - ggplot / data transformation using dplyr</a><ul>
<li class="chapter" data-level="9.1" data-path="lecture-08-ggplot-data-transformation-using-dplyr.html"><a href="lecture-08-ggplot-data-transformation-using-dplyr.html#dplyr-mutate-select-"><i class="fa fa-check"></i><b>9.1</b> dplyr mutate / select 함수</a></li>
<li class="chapter" data-level="9.2" data-path="lecture-08-ggplot-data-transformation-using-dplyr.html"><a href="lecture-08-ggplot-data-transformation-using-dplyr.html#ggplot2----bar-graph--"><i class="fa fa-check"></i><b>9.2</b> ggplot2를 이용한 두 개의 bar graph 겹쳐 그리기</a></li>
<li class="chapter" data-level="9.3" data-path="lecture-08-ggplot-data-transformation-using-dplyr.html"><a href="lecture-08-ggplot-data-transformation-using-dplyr.html#dplyr--iris-data-"><i class="fa fa-check"></i><b>9.3</b> dplyr 이용한 iris data 가공</a></li>
<li class="chapter" data-level="9.4" data-path="lecture-08-ggplot-data-transformation-using-dplyr.html"><a href="lecture-08-ggplot-data-transformation-using-dplyr.html#ggplot--iris-data-------"><i class="fa fa-check"></i><b>9.4</b> ggplot을 이용한 iris data 평균 값 및 에러 비교 그래프 그리기</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lecture-09-ggplot-dlyr-for-96well-fluorescence-data.html"><a href="lecture-09-ggplot-dlyr-for-96well-fluorescence-data.html"><i class="fa fa-check"></i><b>10</b> Lecture 09 - ggplot / dlyr for 96well fluorescence data</a><ul>
<li class="chapter" data-level="10.1" data-path="lecture-09-ggplot-dlyr-for-96well-fluorescence-data.html"><a href="lecture-09-ggplot-dlyr-for-96well-fluorescence-data.html#dplyr-functions"><i class="fa fa-check"></i><b>10.1</b> dplyr functions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">[2019 UST 일반강의] R 프로그래밍과 데이터 분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lecture-07---ggplot-data-transformation" class="section level1">
<h1><span class="header-section-number">8</span> Lecture 07 - ggplot / data transformation</h1>
<p>지난 시간 실습용 파일들 중 일부가 업데이트 되었습니다. 다시 다운로드 받아 주세요</p>
<p><a href="https://github.com/greendaygh/Rprog2019/blob/master/exp_design2.xlsx">design excel file 2</a><br />
<a href="https://github.com/greendaygh/Rprog2019/blob/master/20171012-phenol-1.xls">data excel file 1</a><br />
<a href="https://github.com/greendaygh/Rprog2019/blob/master/20171012-phenol-2.xls">data excel file 2</a><br />
<a href="https://github.com/greendaygh/Rprog2019/blob/master/20171227-phenol-1.xls">data excel file 3</a><br />
<a href="https://github.com/greendaygh/Rprog2019/blob/master/20171227-phenol-2.xls">data excel file 4</a><br />
<a href="https://github.com/greendaygh/Rprog2019/blob/master/read_plate.R">R function for plate read</a></p>
<p>수업 전 다음 패키지 설치가 필요합니다. 인터넷 연결된 상태에서 Rstudio 콘솔창에 다음을 입력하세요</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</code></pre></div>
<p>강의 노트 (강의 자료 업데이트가 늦었습니다) <a href="https://github.com/greendaygh/2019-R-programming/blob/master/07-Rprog.pdf">Lecture note</a></p>
<p>이번 강의에서는 두 가지 패키지의 사용법을 알아봅니다. 하나는 ggplot2로 지난 시간에 이어서 barplot 을 그리는 연습을 할 예정이며 다른 하나의 패키지는 dplyr 입니다. dplyr은 plyr의 확장 버전으로 데이터프레임 형식의 데이터를 손쉽게 다룰수 있게 해주는 도구 입니다. 최근 그 유용성이 알려지며 R 사용자들이 많이 쓰는 패키지 중 하나 입니다. 뒤에서 좀 더 자세히 다루기로 하고 ggplot에 대해서 먼저 실습을 해 보겠습니다.</p>
<div id="bar-graph-with-basic-graph-functions" class="section level2">
<h2><span class="header-section-number">8.1</span> Bar graph with basic graph functions</h2>
<p>Bar graph를 그리기 위한 데이터는 강의시간에 소개드린 것처럼 크게 4가지 분류로 나눌 수 있습니다. 아래 예제들이 그 예이며 각각에 대한 bar graph를 그릴 수 있습니다. 이 예제들은 ggplot의 stat 옵션을 설명하기 위한 예제들로 특정 변수에 대한 그래프를 그릴 때 변수의 값들을 count를 해야할지 아니면 그 값 그대로를 그릴지에 대한 설명을 이해하는데 도움을 줄 있습니다.</p>
<p>첫 번째는 x 변수가 연속형 (continuous)인 경우로 대부분의 경우 bar 그래프는 histogram 을 표현하는데 사용 됩니다. 즉, 특정 구간 내에 포함되는 x의 값의 갯수 (count)를 bar로 표현하는 것 입니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)
<span class="kw">hist</span>(x, <span class="dt">br=</span><span class="dv">10</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>두 번째는 하나의 변수 x의 값이 이산형 (discrete) 일 경우에는 x가 갖는 각 값이 몇 개인지를 (count) 나타내기 위해서 bar 그래프를 그릴 수 있을 것 입니다. 아래 코드에서는 x 값 범주의 counting을 위해 table 함수를 사용하였습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">100</span>, <span class="dt">replace =</span> T)
count_x &lt;-<span class="st"> </span><span class="kw">table</span>(x)
<span class="kw">barplot</span>(count_x)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>앞서 두 경우가 하나의 x 변수에 대한 값들을 bar graph로 표현한 경우라면 세 번째와 네 번째 경우는 변수가 두 개인 경우라고 볼 수 있습니다. 그 중 세번째 경우로 두 변수 x, y 가 있을 경우 x가 연속형 값을 갖고 y는 각 x 값의 빈도수를 나타내는 상황을 생각할 수 있습니다. 예를 들어 1.212값을 갖는 데이터가 20개이다 라는 상황을 가정할 경우 x=1.212 가 되고 y=20이 됩니다. 이 경우는 앞에서와 같은 카운팅은 필요 없이 x, y 값 그대로를 화면에 그려주면 됩니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
<span class="kw">plot</span>(x, y, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>마지막으로 앞서와 같이 두 개의 변수로 이루어져 있으나 x가 연속형이 아닌 이산형 변수라는 점이 다릅니다. y는 각 x 값들의 빈도수를 나타내며 이 경우도 x의 빈도수가 y값에 저장되어 있으니 y 값 그대로를 화면에 그려주면 됩니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>
y &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">sample</span>(x, <span class="dv">100</span>, <span class="dt">replace =</span> T))
<span class="kw">barplot</span>(y)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
</div>
<div id="bar-graph-with-ggplot" class="section level2">
<h2><span class="header-section-number">8.2</span> Bar graph with ggplot</h2>
<p>이제 앞서와 같은 4가지 데이터들을 ggplot을 이용하여 차례로 bar graph를 그려 보겠습니다. ggplot의 사용은 강의 시간 설명을 참고하시고 간단히 ggplot 함수로 먼저 데이터와 aes로 (미학요소 또는 미적요소) x축 y축 등을 명시하고 <code>+</code> 오퍼레이터를 사용하여 필요한 레이어를 차례로 추가하면서 그래프를 그릴 수 있습니다.</p>
<p>x가 연속형일 경우 아래와 같이 histogram을 그려 줍니다. continuous 일 경우 stat은 bin으로 하면 특정 범위 안에 있는 값들의 빈도수를 계산하여 히스토그램을 그려줍니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1=</span><span class="kw">rnorm</span>(<span class="dv">100</span>))
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x1)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;bin&quot;</span>, <span class="dt">bins=</span><span class="dv">30</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>x가 이산형인 경우는 stat을 count로 설정하여 해당 값들의 빈도수를 그려줄 수 있으며</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">100</span>, <span class="dt">replace =</span> T)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">factor</span>(x))
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<p>세 번째, 네 번째 경우 x, y 두 변수에서 y가 x의 빈도수를 저장하고 있을 경우 x가 연속형, 이산형에 상관 없이 stat을 identity로 설정하여 bar graph를 그릴 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)
y1 &lt;-<span class="st"> </span><span class="kw">tabulate</span>(<span class="kw">sample</span>(x1, <span class="dv">100</span>, <span class="dt">replace=</span>T))
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x1, y1)
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x1, <span class="dt">y=</span>y1)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) </code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-84-2.png" width="672" /></p>
<p>ggplot은 다음과 같이 다양한 레이어를 추가하여 필요한 기능을 사용할 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)
y1 &lt;-<span class="st"> </span><span class="kw">tabulate</span>(<span class="kw">sample</span>(x1, <span class="dv">100</span>, <span class="dt">replace=</span>T))
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x1, y1)
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x1, <span class="dt">y=</span>y1, <span class="dt">fill=</span>x1)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Discrete cases&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bar graph for x:discrete and y:value&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
<div id="line-graph-with-ggplot" class="section level2">
<h2><span class="header-section-number">8.3</span> Line graph with ggplot</h2>
<p>다음으로 ggplot을 이용한 line graph를 그리는 방법을 알아 봅니다. 앞서 bar graph와의 관계를 보면 line graph는 bar graph의 각 bar에 해당하는 값들을 서로 선으로 이어주는 graph라고 볼 수 있겠습니다.</p>
<p>Line graph는 geom_line이라는 함수를 사용해서 그릴 수 있으며 stat의 사용법은 앞서 bar graph와 같습니다. Line graph에서 중요한 점은 아래 group 파라미터 입니다. 선이라는 것은 두 점 이상의 값들을 알 경우에만 연결할 수 있고 ggplot에서는 같은 그룹에 (<code>group</code>) 속해있는 두 개 이상의 값들을 선으로 연결한다는 의미 입니다. 그런데 우리가 가진 데이터 <code>dat</code> 에는 group을 나타내는 변수가 없습니다. 따라서 <code>group=1</code>이라고 할 경우 모든 값들이 같은 <code>1</code> 그룹에 있는 것으로 간주되고 모든 값들을 선으로 연결하는 line 그래프가 그려집니다. bar그래프와 다른 점은 <code>group=1</code>과 <code>geom_bar</code> 대신 <code>geom_line</code>을 사용한 점입니다. 그리고 bar graph의 fill 옵션은 bar의 색을 결정하는 부분으로 line 그래프에서는 bar가 없으므로 사용하지 않습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x1, <span class="dt">y=</span>y1, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Discrete cases&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Barplot for x:discrete and y:value&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>추가로 아래와 같이 그려지는 선의 두께를 조절하고 점을 추가로 그려볼 수 있습니다. 점을 그리는 명령어는 geom_point로서 line 과 함께 그리는 것 이므로 <code>+</code> 오퍼레이터를 사용하여 geom_line 과 함께 사용하면 됩니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x1, <span class="dt">y=</span>y1, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">4</span>, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Discrete cases&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Barplot for x:discrete and y:value&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>같은 방법으로 bar 또한 같이 그려줄 수 있습니다. 여기서는 fill 옵션이 geom_bar에 하나 geom_point에 하나씩 쓰였는데 이는 각 geometry에 따라서 필요한 옵션이 다르므로 각각의 geom_xxx 를 사용할 때 상황에 맞게 (help 나 예제를 통해서) 사용하시면 되겠습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x1, <span class="dt">y=</span>y1, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">fill=</span>x1) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">4</span>, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Discrete cases&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Barplot for x:discrete and y:value&quot;</span>)</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>
<div id="bar-graph-of-the-example-dataset" class="section level2">
<h2><span class="header-section-number">8.4</span> Bar graph of the example dataset</h2>
<p>지난 시간까지 작성했던 엑셀 읽는 함수를 사용해서 (비교적 큰) 실제 데이터를 읽어오고 ggplot을 이용하여 bar graph를 그리는 실습을 합니다. 지난 시간 간단히 bargraph를 그려 보았으나 평균, 표준편차를 구할 필요성이 있었으며 비교적 큰 데이터셋에서 그러한 정보를 뽑아내기 위해 ddplyr 이라는 것을 이용할 것이라고 말씀 드리고 마쳤습니다. 이번 시간 ddplyr의 사용법을 아래에서 배울 예정이며 실제 아래 예제를 가지고 평균, 표준편차 bargraph를 그리는 것은 다음 시간에 실습 하도록 하겠습니다. 대신 지난 시간 그렸던 bargraph를 수정된 데이터가 지고 다시 그려보도록 하겠습니다.</p>
<p>아래 일련의 코드를 실행하면 bargraph를 그릴 수 있으며 연속형으로 되어있는 농도 (concentration)을 이산형으로 바꾸는 과정 및 ggplot을 이용한 bargraph 그리는 과정은 지난시간에 이어 수업시간에 말씀드린 내용을 참고하시면 되겠습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;read_plate.R&quot;</span>)

design_file_name &lt;-<span class="st"> &quot;exp_design2.xlsx&quot;</span>
data_file_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;20171012-phenol-1.xls&quot;</span>, 
                     <span class="st">&quot;20171012-phenol-2.xls&quot;</span>, 
                     <span class="st">&quot;20171227-phenol-1.xls&quot;</span>, 
                     <span class="st">&quot;20171227-phenol-2.xls&quot;</span>)

mydata1 &lt;-<span class="st"> </span><span class="kw">multiple_plate_excel_reader2</span>(design_file_name, data_file_names[<span class="dv">1</span>], <span class="dt">sheet4design=</span><span class="dv">1</span>)
mydata2 &lt;-<span class="st"> </span><span class="kw">multiple_plate_excel_reader2</span>(design_file_name, data_file_names[<span class="dv">2</span>], <span class="dt">sheet4design=</span><span class="dv">2</span>)
mydata3 &lt;-<span class="st"> </span><span class="kw">multiple_plate_excel_reader2</span>(design_file_name, data_file_names[<span class="dv">3</span>], <span class="dt">sheet4design=</span><span class="dv">3</span>)
mydata4 &lt;-<span class="st"> </span><span class="kw">multiple_plate_excel_reader2</span>(design_file_name, data_file_names[<span class="dv">4</span>], <span class="dt">sheet4design=</span><span class="dv">4</span>)

mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1, mydata2, mydata3, mydata4)
mydata2 &lt;-<span class="st"> </span>mydata
mydata2<span class="op">$</span>concentration &lt;-<span class="st"> </span><span class="kw">as.factor</span>(mydata2<span class="op">$</span>concentration)

<span class="kw">ggplot</span>(<span class="dt">data=</span>mydata2, <span class="kw">aes</span>(<span class="dt">x=</span>sample_names, <span class="dt">y=</span>GFP, <span class="dt">fill=</span>concentration)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">heat.colors</span>(<span class="dv">11</span>))</code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
<div id="ddplyr---pipe-operator" class="section level2">
<h2><span class="header-section-number">8.5</span> ddplyr - pipe operator</h2>
<p>dplyr은 테이블형 데이터를 다루기 위한 도구를 제공하는 매우 편리한 패키지 입니다. 앞서 ggplot의 <code>+</code> 오퍼레이터와 같이 <code>%&gt;%</code> 파이프 오퍼레이터를 사용하여 여러 함수를 연속적으로 사용할 수 있으며 R의 장점 중 하나인 apply와 같은 행렬 연산 기능을 subset, split, group 와 같은 행렬 편집 기능과 더하여 만들어낸 도구라고 할 수 있습니다.</p>
<p>먼저 파이프 오퍼레이터 <code>%&gt;%</code> 의 작동법은 간단히 <code>%&gt;%</code>의 왼쪽 코드의 결과를 출력으로 받아 오른쪽 코드의 입력 (첫번째 파라미터의 값)으로 받아들이는 작동을 합니다. 다음 예에서 보면 <code>sin(pi)</code> 와 같은 함수의 일반적인 사용법 대신 <code>pi %&gt;% sin</code> 처럼 사용해도 똑같은 결과를 보여줍니다. <code>cos(sin(pi))</code>와 같이 여러 합수를 중첩하여 사용할 경우에도 코드 디자인의 가독성이나 효율 측면에서 크게 향상된 방법을 제공해 줍니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

pi <span class="op">%&gt;%</span><span class="st"> </span>sin</code></pre></div>
<pre><code>## [1] 1.224606e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sin</span>(pi)</code></pre></div>
<pre><code>## [1] 1.224606e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pi <span class="op">%&gt;%</span><span class="st"> </span>sin <span class="op">%&gt;%</span><span class="st"> </span>cos</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cos</span>(<span class="kw">sin</span>(pi))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>특히 <code>%&gt;%</code>는 이후 설명할 dplyr의 group_by, split, filter, summary 등의 행렬 편집/연산 함수를 빈번히 다양한 조합으로 쓰게되는 상황에서 더 큰 효과를 발휘할 수 있습니다. 그에 앞서 pipe 오퍼레이터의 예제를 좀 더 살펴보겠습니다.</p>
<p>pipe operator의 왼쪽 구문의 결과가 오른쪽 구문의 입력으로 처리된다고 설명드렸지만 엄밀히 따지면 오른쪽 구문의 첫 번째 파라미터의 입력 값으로 처리되는 것 입니다. 즉, 함수에서 사용되는 파라미터가 여러개일 경우가 있으므로 기본적으로 <code>%&gt;%</code> 의 왼쪽 구문의 출력 값은 오른쪽 구문 (함수)의 첫 번째 인자의 입력값으로 들어가는 것 입니다. 이는 다음 예들을 통해서 명확히 알 수 있습니다. 먼저 <code>paste</code>함수는 그 파라미터로 <code>,</code>로 구분되는 여러개의 입력 값을 가질 수 있습니다. 따라서 다음 코드는 <code>x</code>가 paste의 첫 번째 파라미터로 들어가게 되어 <code>&quot;1a&quot;, &quot;2a&quot;, &quot;3a&quot;, &quot;4a&quot;, &quot;5a&quot;</code> 로 a 앞에 x 값들이 붙어서 출력된 것을 알 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;a&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;1a&quot; &quot;2a&quot; &quot;3a&quot; &quot;4a&quot; &quot;5a&quot;</code></pre>
<p>특정 데이터셋의 컬럼별 평균을 구하고 각 평균의 합을 구할 경우를 생각해 봅시다. R에서는 <code>colMeans</code>라는 특별한 함수를 제공하여 컬럼별로 평균을 계산해 줍니다. 그 후 sum 함수를 사용하여 최종 원하는 값을 얻을 수 있습니다. 이러한 코드를 <code>%&gt;%</code> 오퍼레이터를 사용한 경우의 코드와 비교해 볼 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>), <span class="dt">y=</span><span class="kw">c</span>(<span class="dv">201</span><span class="op">:</span><span class="dv">300</span>))
<span class="kw">sum</span>(<span class="kw">colMeans</span>(x))</code></pre></div>
<pre><code>## [1] 301</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>), <span class="dt">y=</span><span class="kw">c</span>(<span class="dv">201</span><span class="op">:</span><span class="dv">300</span>))
x <span class="op">%&gt;%</span><span class="st"> </span>colMeans <span class="op">%&gt;%</span><span class="st"> </span>sum</code></pre></div>
<pre><code>## [1] 301</code></pre>
<p>그럼 만약 두 번째 파라미터에 입력으로 왼쪽 구문의 출력을 받아들이고 싶을 경우는 어떻게 할까요? 그럴때는 place holer라는 <code>.</code> 을 사용하면 되겠습니다. round 함수는 두 개의 파라미터를 가지고 digits 값을 pipe operator로 넘겨주고 싶을 경우 아래와 같이 표현할 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">6</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(pi, <span class="dt">digits=</span>.)</code></pre></div>
<pre><code>## [1] 3.141593</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(pi, <span class="dt">digits=</span><span class="dv">6</span>)</code></pre></div>
<pre><code>## [1] 3.141593</code></pre>
</div>
<div id="dplyr---important-functions" class="section level2">
<h2><span class="header-section-number">8.6</span> dplyr - Important functions</h2>
<p>이제 본격적인 dplyr 함수를 사용해 보겠습니다. dplyr을 구성하는 중요한 함수는 다음 6가지가 있습니다.</p>
<ul>
<li>select() - select columns</li>
<li>filter() - filter rows</li>
<li>arrange() - re-order or arrange rows</li>
<li>mutate() - create new columns</li>
<li>summarise() - summarise values</li>
<li>group_by() - allows for group operations in the “split-apply-combine” concept</li>
</ul>
<p>이 함수들은 <code>%&gt;%</code>와 함께 쓰이면서 강력한 성능을 발휘합니다. summarise 함수는 특정 값들의 통계 값을 계산해 주는 함수이며 그 외 5개 함수들은 행렬 편집을 위한 함수들로 보시면 되겠습니다. 각각의 설명보다는 직접 간단한 예제를 수행하면서 각각의 기능을 살펴보고 왜 dplyr이 널리 사용되고 그 장점이 무엇인지 파악해 보도록 하겠습니다.</p>
<p>예제에 사용할 데이터는 iris 데이터로 R을 설치하면 기본으로 들어있는 데이터 입니다. 세 종류의 iris 품종에 대한 꽃잎과 꽃받침의 length와 with를 측정해 놓은 데이터 입니다. <code>head</code>와 <code>str</code> 명령어를 이용해서 데이터를 살펴 봅니다. <code>%&gt;%</code>를 배웠으니 써보겠습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">10</span>)</code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1           5.1         3.5          1.4         0.2  setosa
## 2           4.9         3.0          1.4         0.2  setosa
## 3           4.7         3.2          1.3         0.2  setosa
## 4           4.6         3.1          1.5         0.2  setosa
## 5           5.0         3.6          1.4         0.2  setosa
## 6           5.4         3.9          1.7         0.4  setosa
## 7           4.6         3.4          1.4         0.3  setosa
## 8           5.0         3.4          1.5         0.2  setosa
## 9           4.4         2.9          1.4         0.2  setosa
## 10          4.9         3.1          1.5         0.1  setosa</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span>str</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>데이터를 확인한 후 분석을 시작합니다. 분석은 간단히 각 iris 품종별로 꽃과 꽃받침의 평균을 비교하는 것으로 합니다.</p>
<p>dplyr의 전신이라 할 수 있는 plyr 패키지는 다음과 같이 설명이 되어 있습니다. <em>A set of tools for a common set of problems: you need to split up a big data structure into homogeneous pieces, apply a function to each piece and then combine all the results back together.</em> 즉 split-apply-combine 세 가지 동작을 쉽게 할 수 있도록 만들어 놓은 툴 입니다. R이 다른 언어에 비해 데이터 분석에서 주목을 받는 이유로 split, apply 등의 행렬 연산 함수가 발달한 것을 내세우는데 dplyr은 이들보다 더 편리하게 데이터 조작을 할 수 있도록 만들어 놓은 것 입니다.</p>
<p>이제 split, apply, combine을 활용하여 평균을 구하는 코드와 dplyr 패키지를 사용하여 만든 코드를 비교해 보도록 하겠습니다. split은 factor형 변수인 Species를 기준으로 iris 데이터를 나누어 주는 역할을 하며 lapply는 list 형 데이터인 iris_split을 각 리스트의 각각의 원소들에 대해서 function(x) 를 수행하는 역할을 합니다. 마지막 data.frame으로 최종 경로를 merge 합니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris_split &lt;-<span class="st"> </span><span class="kw">split</span>(iris, iris<span class="op">$</span>Species)
iris_means &lt;-<span class="st"> </span><span class="kw">lapply</span>(iris_split, <span class="cf">function</span>(x){<span class="kw">colMeans</span>(x[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])})
iris_means_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(iris_means)
iris_means_df</code></pre></div>
<pre><code>##              setosa versicolor virginica
## Sepal.Length  5.006      5.936     6.588
## Sepal.Width   3.428      2.770     2.974
## Petal.Length  1.462      4.260     5.552
## Petal.Width   0.246      1.326     2.026</code></pre>
<p>위 코드를 한 줄로 사용하여 최종 iris_means_df 데이터를 를 구한다면 다음과 같이 됩니다. 한눈에 코드가 들어오지 않고 이렇게 중첩해서 함수를 사용하는 습관은 어떤 프로그래밍 언어에서도 권장하지 않습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris_means_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">lapply</span>(<span class="kw">split</span>(iris, iris<span class="op">$</span>Species), <span class="cf">function</span>(x){<span class="kw">colMeans</span>(x[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])}))</code></pre></div>
<p>아래는 dplyr 패키지를 사용한 코드 입니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris_means_df2 &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise_all</span>(mean)
iris_means_df2</code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 setosa             5.01        3.43         1.46       0.246
## 2 versicolor         5.94        2.77         4.26       1.33 
## 3 virginica          6.59        2.97         5.55       2.03</code></pre>
<p>위에서 보듯 dplyr 패키지를 사용할 경우 그 결과는 같으나 코드의 가독성과 효율성면에서 장점을 보여줍니다. 여기서 group_by, summarise_all 함수 등의 사용법은 help 페이지를 참고해 주세요. 간단히 iris 데이터를 받아서 Species에 명시된 그룹으로 나누고 mean 함수를 모든 컬럼에 대해서 사용하라는 의미 입니다.</p>
<p>이제 ggplot을 이용하여 각 평균에 대한 barplot을 그려보도록 하겠습니다. 지난 예제와는 달리 ggplot에서는 data만 명시해 주고 geom_bar에 aes와 stat을 모두 사용한 것이 다릅니다. ggplot 구문에서 지정해주는 aes 등의 옵션은 하위 geom_xxx 레이어들에 모두 적용이 되고 각 geom_xxx 레이어에서 지정해주는 aes는 해당 레이어에서만 효과를 나타냅니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris_means_df2) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Species, <span class="dt">y=</span>Sepal.Length), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) </code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>마지막으로 위 dplyr 패키지를 ggplot 과 함께 사용할 수도 있습니다. 보통은 앞서와 같이 결과를 특정 변수에 저장한 후 도표 등을 그리지만 다음과 같이 <code>%&gt;%</code> 를 사용하여 plot 까지 함께 볼 수도 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Species, <span class="dt">y=</span>Sepal.Length), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) </code></pre></div>
<p><img src="Rprog_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>다음시간에는 dplyr 패키지를 이용하여 실제 예제 데이터의 평균과 표준편차를 구해보고 bar graph외 산포도, heatmap 등의 실습을 해 보도록 하겠습니다.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lecture-06-multiple-plate-reader-ggplot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lecture-08-ggplot-data-transformation-using-dplyr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
