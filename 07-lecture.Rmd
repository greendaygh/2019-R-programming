---
title: "Read plate reader excel files"
author: "Haseong"
date: "2019년 4월 17일"
output: html_document
---

# Lecture 07 - ggplot / data transformation

지난 시간 실습용 파일들 중 일부가 업데이트 되었습니다. 다시 다운로드 받아 주세요 

[design excel file 2](https://github.com/greendaygh/Rprog2019/blob/master/exp_design2.xlsx)  
[data excel file 1](https://github.com/greendaygh/Rprog2019/blob/master/20171012-phenol-1.xls)  
[data excel file 2](https://github.com/greendaygh/Rprog2019/blob/master/20171012-phenol-2.xls)  
[data excel file 3](https://github.com/greendaygh/Rprog2019/blob/master/20171227-phenol-1.xls)  
[data excel file 4](https://github.com/greendaygh/Rprog2019/blob/master/20171227-phenol-2.xls)  
[R function for plate read](https://github.com/greendaygh/Rprog2019/blob/master/read_plate.R)  


수업 전 다음 패키지 설치가 필요합니다. 인터넷 연결된 상태에서 Rstudio 콘솔창에 다음을 입력하세요

```{r eval=FALSE}
install.packages("ggplot2")
install.packages("dplyr")
```

강의 노트 (강의 자료 업데이트가 늦었습니다)
[Lecture note](https://github.com/greendaygh/2019-R-programming/blob/master/07-Rprog.pdf)  


참고로 다음 시간 수업은 연구동 세미나실이 아닌 중회의실 입니다.


이번 강의에서는 두 가지 패키지의 사용법을 알아봅니다. 하나는 ggplot2로 지난 시간에 이어서 barplot 을 그리는 연습을 할 예정이며 다른 하나의 패키지는 dplyr 입니다. dplyr은 plyr의 확장 버전으로 데이터프레임 형식의 데이터를 손쉽게 다룰수 있게 해주는 도구 입니다. 최근 그 유용성이 알려지며 R 사용자들이 많이 쓰는 패키지 중 하나 입니다. 뒤에서 좀 더 자세히 다루기로 하고 ggplot에 대해서 먼저 실습을 해 보겠습니다.   

## barplot with basic graph function

barplot를 그리기 위한 데이터는 강의시간에 소개드린 것처럼 크게 4가지 분류로 나눌 수 있습니다. 아래 예제들이 그 예이며 각각에 대한 bargraph를 그릴 수 있습니다. 이 예제들은 ggplot의 stat을 설명하기 위한 예제들로 특정 변수에 대한 그래프를 그릴 때 변수의 값들을 count를 해야할지 아니면 그 값 그대로를 그릴지에 대한 설명을 이해하는데 도움을 줄 있습니다. 


첫 번째는 x 변수가 연속형 (continuous)인 경우로 bar 그래프를 그린다면 당연히 histogram 외에 다른 bar 그래프는 생각나질 않습니다. 즉, 특정 구간 내에 포함되는 x의 값의 갯수 (count)를 bar로 표현하는 것 입니다. 

```{r}
x <- rnorm(100)
hist(x, br=10)
```

두 번째는 하나의 변수 x의 값이 이산형 (discrete) 일 경우에는 x의 범주의 각 값이 몇 개인지를 (count) 나타내기 위해서 barplot 그래프를 그릴 수 있을 것 입니다. 아래 코드에서는 x 값 범주의 counting을 위해 table 함수를 사용하였습니다. 

```{r}
x <- sample(1:3, 100, replace = T)
count_x <- table(x)
barplot(count_x)
```


이제 변수가 두 개인 경우를 생각할 수 있습니다. 즉, x, y 변수가 있을 경우 x가 연속형 값을 갖고 y는 각 x 값의 빈도수를 나타내는 상황을 생각하시면 됩니다. 예를 들어 1.212값을 갖는 데이터가 20개이다 라는 상황을 가정할 경우 x=1.212 가 되고 y=20이 됩니다. 이 경우는 앞에서와 같은 카운팅은 필요 없이 x, y 값 그대로를 화면에 그려주면 됩니다. 


```{r}
x <- rnorm(10)
y <- rnorm(10)
plot(x, y, type="h")
```

마지막으로 앞서와 같이 두 개의 변수로 이루어져 있으나 x가 연속형이 아닌 이산형 변수이고 y는 각 x 값들의 빈도수를 나타냅니다. 이 경우도 x의 빈도수가 y값에 저장되어 있으니 y 값 그대로를 화면에 그려주면 됩니다. 


```{r}
x <- 1:3
y <- table(sample(x, 100, replace = T))
barplot(y)
```


## barplot with ggplot

이제 앞서와 같은 4가지 상황에서 ggplot을 이용하여 barplot을 그려 보겠습니다. 

```{r echo=FALSE}
library(ggplot2)
```


```{r}
dat <- data.frame(x1=rnorm(100))
ggplot(dat, aes(x=x1)) +
  geom_bar(stat="bin")


x <- sample(1:3, 100, replace = T)
dat <- data.frame(x=factor(x))
ggplot(dat, aes(x=x)) +
  geom_bar(stat="count")


x <- rnorm(10)
y <- rnorm(10)
dat <- data.frame(x, y)
ggplot(dat, aes(x=x, y=y)) +
  geom_bar(stat="identity")


x1 <- as.factor(1:3)
y1 <- tabulate(sample(x1, 100, replace=T))
dat <- data.frame(x1, y1)
ggplot(dat, aes(x=x1, y=y1)) +
  geom_bar(stat="identity") 

ggplot(dat, aes(x=x1, y=y1, fill=x1)) +
  geom_bar(stat="identity") 

ggplot(dat, aes(x=x, y=y, fill=x)) +
  geom_bar(stat="identity") +
  guides(fill=FALSE)


ggplot(dat, aes(x=x, y=y, fill=x)) +
  geom_bar(stat="identity") +
  guides(fill=FALSE) +
  xlab("Discrete cases") + 
  ylab("Value") +
  ggtitle("Barplot for x:discrete and y:value") 


ggplot(dat, aes(x=x, y=y, fill=x)) +
  geom_bar(stat="identity") +
  guides(fill=FALSE) +
  xlab("Discrete cases") + 
  ylab("Value") +
  ylim(c(0,50))+
  ggtitle("Barplot for x:discrete and y:value")

```








